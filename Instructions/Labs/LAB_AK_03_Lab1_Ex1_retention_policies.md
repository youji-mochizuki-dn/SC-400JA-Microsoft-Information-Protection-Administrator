# 演習 1 - 保持ポリシーを構成する

この演習では、Contoso Ltd. のシステム管理者である Joni Sherman のロールを実行します。この企業はテキサスを本拠地としており、記録は 3 年を経過したら削除しても違法ではない、という州法を遵守するために保持ポリシーを実装する必要があります。 

この法律を遵守するために、組織ではすべてのアイテムを 3 年間保持する保持計画を作成しています。


### タスク 1 – 全社的な保持ポリシーを作成する

この演習では、全社的な保持ポリシーを作成し、保持期間を適用し、ポリシーを適用する場所を設定します。

1. Client 1 VM (LON-CL1) に **lon-cl1\admin** アカウントでログインします。

2. **Microsoft Edge** で、**https://compliance.microsoft.com** に移動し、**Joni Sherman** JoniS@WWLxZZZZZZ.onmicrosoft.com (ZZZZZZ はラボ ホスティング プロバイダーから提供された固有のテナント ID) としてコンプライアンス センターにログインします。  Joni のパスワードは、ラボ ホスティング プロバイダーから支給されます。

3. **コンプライアンス センター**の左側のナビゲーション ウィンドウで **「ポリシー」** を選択し、**「データ」** で **「保持」** を選択します。

4. **「情報ガバナンス」** ページの **「保持」** タブで、**「+ アイテム保持ポリシーの新規作成」** を選択します。

5. **「ポリシーの名前を設定」** ページの **「名前」** と **「説明」** に、次の情報を入力します。

	- 名前: 会社全体
	- 説明: Teams を除くすべての場所

6. **「次へ」** ボタンを選択します。  

7. **「ポリシーを適用する場所を選択する」** 領域で、Exchange メール、SharePoint サイト、OneDrive アカウント、 Microsoft 365 グループが選択されていることを確認し、**「次へ」** を選択します。

8. **「保持の設定」** ページの **「アイテムを特定の期間保持する」** セクションで、次の情報を入力します。

	- アイテムを特定の期間保持する: 3 年
	- **保持期間開始の条件**: 最終更新日時

9. **「次へ」** ボタンを選択します。

10. **「設定の確認」** ページで、**「送信」** ボタンを選択します

Exchange メール、Microsoft 365 グループ、OneDrive、SharePoint サイトの場所に対する保持ポリシーが正常に作成されました。この保持ポリシーでは、これらの場所にあるアイテムを、アイテムの最終変更日から 3 年間保持します。テナントに適用されるまで、最大で 24 時間かかる場合があります。

### タスク 2 – フィルター付きの、場所に基づく保持ポリシーを作成する

ここでは、Teams の場所の保持ポリシーを作成します。Teams のチャネルにはドキュメントを含めることができるで、それらはすべて保持されます。組織では、限られた数のユーザーに Teams のチャットの保持期間を要求することにしました。

1. Client 1 VM (LON-CL1) には **lon-cl1\admin** アカウントでログインし、Microsoft 365 には **Joni Sherman** としてログインしておく必要があります。 

2. **Microsoft Edge** で、「Office 365 コンプライアンス センター」タブを開いておく必要があります。そうなっている場合は、それを選択し、次の手順に進みます。閉じてしまった場合は、新しいタブで **https://compliance.microsoft.com** に移動します。

3. **コンプライアンス センター**の左側のナビゲーション ウィンドウで **「ポリシー」** を選択し、**「データ」** で **「保持」** を選択します。

4. **「情報ガバナンス」** ページの **「保持」** タブで、**「+ アイテム保持ポリシーの新規作成」** を選択します。

5. **「ポリシーの名前を設定」** ページの **「名前」** と **「説明」** に、次の情報を入力します。

	- **名前**: Teams 保持
	- **説明**: Teams の場所に対する保持

6. **「次へ」** ボタンを選択します。

7. **「場所」** ページで、次の設定を入力します。

	- **Exchange メール**の場所 - **ステータス**: 無効
	- **SharePoint サイト**の場所 - **ステータス**: 無効
	- **OneDrive アカウント**の場所 - **ステータス**: 無効
	- **Office 365 グループ**の場所 - **ステータス**: 無効
	- **Skype for Business**の場所 - **ステータス**: 無効
	- **Exchange のパブリック フォルダー**の場所 - **ステータス**: 無効
	- **Teams のチャネル メッセージ**の場所 – **ステータス**: 有効 
	- **Teams のチャット**の場所 – **ステータス**: 有効

8. Teams のチャットの場所として、**「対象」** 列の **「テキスト リンクの編集」** を選択します。

9. **「場所の編集」** ページの「Teams のチャット」ウィンドウで、ユーザーを追加します。 
    - Adele Vance
    - Pradeep Gupta

10. **「完了」** ボタンを選択します。

11. 「場所」ページに、次の通知が表示されます。**2 人のユーザー**が追加されました

12. **「次へ」** ボタンを選択します。

13. **「保持の設定」** ページの **「アイテムを特定の期間保持する」** セクションで、次の情報を入力します。

	- アイテムを特定の期間保持する: 3 年
	- **保持期間開始の条件**: 最終更新日時

14. **「次へ」** ボタンを選択します。

15. **「設定の確認」** ページで、**「送信」** ボタンを選択します。

Teams の場所に対する保持ポリシーが正常に作成されました。すべての Teams チャネルの場所に 3 年間の保持期間を設定しました。特定のユーザーにのみ適用されるように、Teams チャットの場所のフィルターを設定しました。

### タスク 3 – PowerShell で保持ポリシーを作成する

PowerShell を使用して同じ保持ポリシーを作成します

1. Client 2 VM (LON-CL1) に **lon-cl1\admin** アカウントでログインします。

2. マウスの右ボタンで Windows ボタンを選択して管理者特権で PowerShell ウィンドウを開き、**「Windows PowerShell (管理者)」** を選択します。「ユーザー アカウント制御」ウィンドウが表示されたら、**「はい」** を選択します。

3. 次のコマンドレットを使用して、テナントのセキュリティ/コンプライアンス センターに接続します。

    Connect-IPPSSession

4. サインインを要求するダイアログ ボックスが表示された場合は、**MOD Administrator** admin@WWLxZZZZZZ.onmicrosoft.com (ZZZZZZ はラボ ホスティング プロバイダーから支給された固有のテナント ID) としてサインインします。  管理者のパスワードは、ラボ ホスティング プロバイダーから支給されます。

5. 次のコマンドレットを実行して、Teams を除くすべての場所に対する最初の保持ポリシーを作成します。

    New-RetentionCompliancePolicy -Name "Company Wide PS" -ExchangeLocation All -ModernGroupLocation All -PublicFolderLocation All -SharePointLocation All -OneDriveLocation All

6. 次のコマンドレットを実行して、保持期間を設定します。単位は、変更日を基準にした日数を使用します。
	
    New-RetentionComplianceRule -Name "Company Wide PS Rule" -Policy "Company Wide PS" -RetentionDuration 1095 -ExpirationDateOption ModificationAgeInDays -RetentionComplianceAction Keep

7. 次のコマンドレットを実行して、Teams の場所に対する 2 つ目の保持ポリシーを作成します。

    New-RetentionCompliancePolicy -Name "Teams Retention PS" -TeamsChannelLocation All -TeamsChatLocation "Adele Vance", "Pradeep Gupta"

8. 次のコマンドレットを実行して、日数を単位として保持期間を設定します。

    New-RetentionComplianceRule -Name "Teams Retention PS Rule" -Policy "Teams Retention PS" -RetentionDuration 1095 -RetentionComplianceAction Keep

PowerShell を使って保持期間を 3 年に設定した保持ポリシーを正常に作成しました。

# 演習 2 に進みます。
